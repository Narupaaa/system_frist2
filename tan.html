<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8">
  <title>ค้นหาบริษัท (ลิ้งสำเร็จรูป)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
  <div class="container py-4">
    <h1 class="h4 mb-3">รายชื่อบริษัท → ลิ้งค้นหา</h1>

    <!-- Search box (filter rows) -->
    <div class="mb-3">
      <input id="filterInput" type="text" class="form-control" placeholder="พิมพ์เพื่อค้นหาในตาราง...">
    </div>

    <div class="card shadow-sm">
      <div class="card-body p-0">
        <div class="table-responsive">
          <table class="table table-hover align-middle mb-0">
            <thead class="table-dark">
              <tr>
                <th style="width:72px;">#</th>
                <th>ชื่อบริษัท (TH)</th>
                <th>ชื่อบริษัท (EN)</th>
                <th style="width:220px;">ลิ้งค้นหา</th>
              </tr>
            </thead>
            <tbody id="companyTbody">
              <!-- rows injected by JS -->
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <p class="text-muted small mt-3">
      * ปุ่ม “โทร/เบอร์” จะค้นหาโดยเพิ่มคำว่า โทร หรือ เบอร์ เพื่อหาเบอร์ติดต่อจากหน้าเว็บสาธารณะ
    </p>
  </div>

  <script>
    // ====== ตัวอย่างข้อมูลบริษัท ======
    // ใส่ชื่อไทย (th) และถ้ามีชื่ออังกฤษ (en) จะช่วยให้ค้นหาแม่นยำขึ้น
    const companies = [
      { th: "บริษัท 04 คอนสตรัคชั่น จำกัด", en: "04 CONSTRUCTION COMPANY LIMITED" },
      { th: "บริษัท เอ บี ซี จำกัด", en: "ABC COMPANY LIMITED" },
      { th: "บริษัท เดโม เทคโนโลยี จำกัด", en: "DEMO TECHNOLOGY CO., LTD." },
      { th: "ห้างหุ้นส่วนจำกัด สมมุติการค้า", en: "" }
    ];

    // ====== Helpers ======
    function quotedOr(th, en) {
      // สร้างข้อความค้นหา: "TH" OR "EN" (ถ้ามี EN)
      const qTH = `"${th}"`;
      const qEN = en ? ` OR "${en}"` : "";
      return qTH + qEN;
    }

    function googleUrl(query) {
      return "https://www.google.co.th/search?q=" + encodeURIComponent(query);
    }

    function buildGoogleLink(th, en) {
      const q = quotedOr(th, en);
      return googleUrl(q);
    }

    function buildGooglePhoneLink(th, en) {
      // เพิ่มคำหลัก โทร|เบอร์ เพื่อหาเบอร์ติดต่อ
      const q = `${quotedOr(th, en)} โทร OR เบอร์`;
      return googleUrl(q);
    }

    function buildMapsLink(th, en) {
      // ใช้ชื่อไทยเป็นหลัก; ถ้ามี EN ให้รวมด้วยเพื่อความแม่นยำ
      const q = en ? `${th} ${en}` : th;
      return "https://www.google.com/maps/search/?api=1&query=" + encodeURIComponent(q);
    }

    function buildDBDLink(th, en) {
      // ค้นหาหน้า DBD ผ่าน Google ด้วย site: (เหมาะเป็นลิ้งลัด)
      const q = `site:datawarehouse.dbd.go.th ${quotedOr(th, en)}`;
      return googleUrl(q);
    }

    function renderRows(list) {
      const tbody = document.getElementById("companyTbody");
      tbody.innerHTML = "";
      list.forEach((c, idx) => {
        const tr = document.createElement("tr");

        // ลำดับ
        const tdNo = document.createElement("td");
        tdNo.className = "text-muted";
        tdNo.textContent = idx + 1;
        tr.appendChild(tdNo);

        // ชื่อไทย
        const tdTH = document.createElement("td");
        tdTH.textContent = c.th || "";
        tr.appendChild(tdTH);

        // ชื่ออังกฤษ
        const tdEN = document.createElement("td");
        tdEN.textContent = c.en || "";
        tr.appendChild(tdEN);

        // ปุ่มลิ้งค้นหา (ใช้ปุ่มกลุ่ม + dropdown)
        const tdActions = document.createElement("td");
        tdActions.innerHTML = `
          <div class="btn-group">
            <a class="btn btn-sm btn-primary" href="${buildGoogleLink(c.th, c.en)}" target="_blank" rel="noopener noreferrer">Google</a>
            <button class="btn btn-sm btn-primary dropdown-toggle dropdown-toggle-split" data-bs-toggle="dropdown" aria-expanded="false">
              <span class="visually-hidden">Toggle Dropdown</span>
            </button>
            <ul class="dropdown-menu dropdown-menu-end">
              <li><a class="dropdown-item" href="${buildGooglePhoneLink(c.th, c.en)}" target="_blank" rel="noopener noreferrer">Google (โทร/เบอร์)</a></li>
              <li><a class="dropdown-item" href="${buildMapsLink(c.th, c.en)}" target="_blank" rel="noopener noreferrer">Google Maps</a></li>
              <li><a class="dropdown-item" href="${buildDBDLink(c.th, c.en)}" target="_blank" rel="noopener noreferrer">DBD (ผ่าน Google)</a></li>
            </ul>
          </div>
        `;
        tr.appendChild(tdActions);

        tbody.appendChild(tr);
      });
    }

    // กรองตารางแบบทันที
    function setupFilter() {
      const input = document.getElementById("filterInput");
      input.addEventListener("keyup", () => {
        const kw = input.value.toLowerCase();
        const filtered = companies.filter(c =>
          (c.th || "").toLowerCase().includes(kw) ||
          (c.en || "").toLowerCase().includes(kw)
        );
        renderRows(filtered);
      });
    }

    // เริ่มทำงาน
    renderRows(companies);
    setupFilter();
  </script>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
